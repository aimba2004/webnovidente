<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Registro de Contacto de Emergencia - VisioGuide</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
  <style>
    :root {
      --primary: #4361ee;
      --primary-dark: #3a56d4;
      --secondary: #ff6b6b;
      --accent: #4cc9f0;
      --emergency: #e74c3c;
      --light: #f8f9fa;
      --dark: #212529;
      --gray: #6c757d;
      --success: #52b788;
      --error: #e5383b;
      --border-radius: 12px;
      --box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }

    .app-container {
      width: 100%;
      max-width: 800px;
      display: flex;
      flex-direction: column;
      gap: 30px;
    }

    header {
      text-align: center;
      padding: 20px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 15px;
    }

    .logo-icon {
      font-size: 2.5rem;
      color: var(--accent);
    }

    h1 {
      color: white;
      font-size: 2.2rem;
      font-weight: 700;
    }

    .tagline {
      color: rgba(255, 255, 255, 0.85);
      font-size: 1.1rem;
      margin-top: 10px;
    }

    .registration-section {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 40px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .section-title {
      color: var(--dark);
      font-size: 1.8rem;
      margin-bottom: 10px;
      position: relative;
      padding-bottom: 10px;
      text-align: center;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 4px;
      background: var(--primary);
      border-radius: 2px;
    }

    .info-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: #fef2f2;
      color: var(--emergency);
      border: 1px solid #fecaca;
      padding: 15px 20px;
      border-radius: 30px;
      font-weight: 600;
      margin: 10px auto;
      font-size: 0.95rem;
      text-align: center;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    label {
      font-weight: 600;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    label i {
      color: var(--primary);
    }

    .input-with-icon {
      position: relative;
    }

    input {
      width: 100%;
      padding: 15px 15px 15px 45px;
      border: 2px solid #e9ecef;
      border-radius: var(--border-radius);
      font-size: 1rem;
      transition: var(--transition);
    }

    input:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }

    .input-icon {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
      font-size: 1.2rem;
    }

    .password-container {
      position: relative;
    }

    .toggle-password {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--gray);
      cursor: pointer;
      font-size: 1.2rem;
    }

    .buttons-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 20px;
    }

    button {
      padding: 15px;
      border: none;
      border-radius: var(--border-radius);
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .register-btn {
      background: var(--emergency);
      color: white;
    }

    .register-btn:hover {
      background: #c0392b;
      transform: translateY(-2px);
    }

    .register-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .login-btn {
      background: white;
      color: var(--primary);
      border: 2px solid var(--primary);
    }

    .login-btn:hover {
      background: #f0f5ff;
      transform: translateY(-2px);
    }

    #mensaje {
      min-height: 24px;
      padding: 15px;
      border-radius: var(--border-radius);
      text-align: center;
      font-weight: 500;
      transition: var(--transition);
      margin-top: 10px;
    }

    .error {
      background: rgba(229, 56, 59, 0.1);
      color: var(--error);
      border: 1px solid rgba(229, 56, 59, 0.2);
    }

    .success {
      background: rgba(82, 183, 136, 0.1);
      color: var(--success);
      border: 1px solid rgba(82, 183, 136, 0.2);
    }

    .password-strength {
      height: 6px;
      background: #e9ecef;
      border-radius: 3px;
      margin-top: 5px;
      overflow: hidden;
    }

    .strength-meter {
      height: 100%;
      width: 0;
      transition: width 0.3s ease;
      background: var(--error);
    }

    .strength-weak {
      background: var(--error);
      width: 33%;
    }

    .strength-medium {
      background: #ffc107;
      width: 66%;
    }

    .strength-strong {
      background: var(--success);
      width: 100%;
    }

    .password-hints {
      font-size: 0.85rem;
      color: var(--gray);
      margin-top: 5px;
    }

    .password-hints ul {
      padding-left: 20px;
      margin-top: 5px;
    }

    .password-hints li {
      margin-bottom: 3px;
    }

    .accessibility-section {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .access-btn {
      background: rgba(67, 97, 238, 0.1);
      color: var(--primary);
      border: none;
      padding: 8px 15px;
      border-radius: 30px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: var(--transition);
      cursor: pointer;
    }

    .access-btn:hover {
      background: rgba(67, 97, 238, 0.2);
    }

    footer {
      text-align: center;
      color: rgba(255, 255, 255, 0.7);
      padding: 20px;
      font-size: 0.9rem;
    }

    .high-contrast {
      --primary: #000000;
      --primary-dark: #000000;
      --secondary: #ffff00;
      --accent: #00ffff;
      --light: #ffffff;
      --dark: #000000;
      background: #ffffff;
      color: #000000 !important;
    }

    .high-contrast .registration-section {
      background: #ffffff;
      color: #000000 !important;
      border: 2px solid #000000;
    }

    .high-contrast .info-badge {
      background: #ffffff;
      color: #000000 !important;
      border: 2px solid #000000;
    }

    .high-contrast .section-title {
      color: #000000;
    }

    .high-contrast label {
      color: #000000;
    }

    @media (max-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .accessibility-section {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <header>
      <div class="logo">
        <i class="fas fa-eye-slash logo-icon"></i>
        <div>
          <h1>VisioGuide</h1>
          <p class="tagline">Sistema de Registro Unificado</p>
        </div>
      </div>
    </header>

    <section class="registration-section">
      <h2 class="section-title">Registro de Contacto de Emergencia</h2>
      
      <div class="info-badge">
        <i class="fas fa-phone-alt"></i>
        <span>Tu cuenta ser√° registrada como contacto de emergencia para personas no videntes</span>
      </div>
      
      <form id="registroForm">
        <div class="form-grid">
          <div class="form-group">
            <label for="nombre"><i class="fas fa-user"></i> Nombre</label>
            <div class="input-with-icon">
              <i class="fas fa-user input-icon"></i>
              <input type="text" id="nombre" name="nombre" placeholder="Ingresa tu nombre" autocomplete="given-name" required>
            </div>
          </div>
          
          <div class="form-group">
            <label for="apellido"><i class="fas fa-user"></i> Apellido</label>
            <div class="input-with-icon">
              <i class="fas fa-user input-icon"></i>
              <input type="text" id="apellido" name="apellido" placeholder="Ingresa tu apellido" autocomplete="family-name" required>
            </div>
          </div>
          
          <div class="form-group">
            <label for="cedula"><i class="fas fa-id-card"></i> C√©dula</label>
            <div class="input-with-icon">
              <i class="fas fa-id-card input-icon"></i>
              <input type="text" id="cedula" name="cedula" placeholder="Ingresa tu c√©dula" autocomplete="off" maxlength="10" required>
            </div>
          </div>
          
          <div class="form-group">
            <label for="direccion"><i class="fas fa-home"></i> Direcci√≥n</label>
            <div class="input-with-icon">
              <i class="fas fa-home input-icon"></i>
              <input type="text" id="direccion" name="direccion" placeholder="Ingresa tu direcci√≥n" autocomplete="street-address" required>
            </div>
          </div>
          
          <div class="form-group">
            <label for="telefono"><i class="fas fa-phone-alt"></i> Tel√©fono de emergencia</label>
            <div class="input-with-icon">
              <i class="fas fa-phone-alt input-icon"></i>
              <input type="tel" id="telefono" name="telefono" placeholder="0987654321" autocomplete="tel" maxlength="10" required>
            </div>
            <small class="password-hints">Este n√∫mero debe coincidir con el registrado en la app m√≥vil del no vidente</small>
          </div>
          
          <div class="form-group">
            <label for="email"><i class="fas fa-envelope"></i> Correo electr√≥nico</label>
            <div class="input-with-icon">
              <i class="fas fa-envelope input-icon"></i>
              <input type="email" id="email" name="email" placeholder="usuario@ejemplo.com" autocomplete="email" required>
            </div>
          </div>
          
          <div class="form-group">
            <label for="password"><i class="fas fa-lock"></i> Contrase√±a</label>
            <div class="password-container">
              <div class="input-with-icon">
                <i class="fas fa-lock input-icon"></i>
                <input type="password" id="password" name="password" placeholder="Crea una contrase√±a segura" autocomplete="new-password" required>
              </div>
              <button type="button" class="toggle-password" id="togglePassword" aria-label="Mostrar contrase√±a">
                <i class="fas fa-eye"></i>
              </button>
            </div>
            <div class="password-strength">
              <div class="strength-meter" id="passwordStrength"></div>
            </div>
            <div class="password-hints">
              <p>La contrase√±a debe contener:</p>
              <ul>
                <li>M√≠nimo 8 caracteres</li>
                <li>Al menos una letra may√∫scula</li>
                <li>Al menos un n√∫mero</li>
                <li>Un car√°cter especial (ej. !@#$%)</li>
              </ul>
            </div>
          </div>
        </div>
        
        <div id="mensaje"></div>
        
        <div class="buttons-container">
          <button type="submit" class="register-btn" id="submitBtn">
            <i class="fas fa-user-plus"></i> Registrar Contacto de Emergencia
          </button>
          <button type="button" class="login-btn" onclick="window.location.href='index.html'">
            <i class="fas fa-sign-in-alt"></i> Volver al Login
          </button>
        </div>
      </form>
      
      <div class="accessibility-section">
        <button class="access-btn" onclick="toggleContrast()">
          <i class="fas fa-adjust"></i> Alto Contraste
        </button>
        <button class="access-btn" onclick="increaseFontSize()">
          <i class="fas fa-text-height"></i> Aumentar Texto
        </button>
      </div>
    </section>

    <footer>
      <p>VisioGuide &copy; 2024 - Todos los derechos reservados</p>
      <p>Registro de contactos de emergencia para personas no videntes</p>
    </footer>
  </div>

<script>
// Configuraci√≥n de Firebase
const firebaseConfig = {
  apiKey: "AIzaSyDHLdHbKhbvSg-ET9BKgPnKqqX0IagShac",
  authDomain: "proyectonovidente-d1e58.firebaseapp.com",
  databaseURL: "https://proyectonovidente-d1e58-default-rtdb.firebaseio.com",
  projectId: "proyectonovidente-d1e58",
  storageBucket: "proyectonovidente-d1e58.appspot.com",
  messagingSenderId: "1089641196998",
  appId: "1:1089641196998:web:f95785dec09af8136b56c7",
  measurementId: "G-PVFZ0EL8VQ"
};

// Inicializar Firebase
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const database = firebase.database();

// Variables globales para accesibilidad
let isHighContrast = false;
let currentFontSize = 16;

// Funci√≥n principal de registro
async function registrar(event) {
  if (event) {
    event.preventDefault();
  }

  const submitBtn = document.getElementById("submitBtn");
  submitBtn.disabled = true;
  submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Registrando...';

  try {
    // Obtener valores del formulario
    const formData = getFormData();
    
    // Validar datos
    if (!validateFormData(formData)) {
      return;
    }

    showMessage("Verificando datos...", "success");

    // Verificar si ya existe un usuario con la misma c√©dula
    const exists = await verificarUsuarioExistente(formData.cedula);
    if (exists) {
      showMessage("Ya existe un usuario registrado con esa c√©dula.", "error");
      return;
    }

    showMessage("Creando cuenta...", "success");

    // Crear usuario en Firebase Authentication
    const userCredential = await auth.createUserWithEmailAndPassword(formData.email, formData.password);
    const uid = userCredential.user.uid;

    showMessage("Guardando informaci√≥n...", "success");

    // Crear objeto de usuario
    const nuevoUsuario = {
      nombre: formData.nombre,
      apellido: formData.apellido,
      cedula: formData.cedula,
      direccion: formData.direccion,
      telefonoEmergencia: formData.telefono,
      tipo: "Contacto de emergencia",
      email: formData.email,
      fechaRegistro: new Date().toISOString(),
      activo: true,
      uid: uid
    };

    console.log("Intentando guardar usuario:", nuevoUsuario);
    console.log("UID del usuario:", uid);

    // Guardar en Firebase Realtime Database
    await database.ref("usuarios/" + uid).set(nuevoUsuario);
    
    console.log("Usuario guardado exitosamente en la base de datos");

    showMessage("¬°Contacto de emergencia registrado exitosamente! Redirigiendo...", "success");
    
    // Verificar que se guard√≥ correctamente
    const verificacion = await database.ref("usuarios/" + uid).once("value");
    if (verificacion.exists()) {
      console.log("Verificaci√≥n exitosa: usuario existe en la base de datos");
    } else {
      console.error("ERROR: El usuario no se guard√≥ en la base de datos");
      throw new Error("Error al guardar en la base de datos");
    }

    // Cerrar sesi√≥n inmediatamente para que vaya al login
    await auth.signOut();

    // Redirecci√≥n despu√©s de 2 segundos
    setTimeout(() => {
      window.location.href = "index.html";
    }, 2000);

  } catch (error) {
    console.error("Error completo en el registro:", error);
    console.error("C√≥digo del error:", error.code);
    console.error("Mensaje del error:", error.message);
    
    // Si es un error de la base de datos, intentar nuevamente
    if (error.code === 'PERMISSION_DENIED' || error.message.includes("base de datos")) {
      console.log("Reintentando guardar en la base de datos...");
      try {
        const uid = auth.currentUser?.uid;
        if (uid) {
          const formData = getFormData();
          const nuevoUsuario = {
            nombre: formData.nombre,
            apellido: formData.apellido,
            cedula: formData.cedula,
            direccion: formData.direccion,
            telefonoEmergencia: formData.telefono,
            tipo: "Contacto de emergencia",
            email: formData.email,
            fechaRegistro: new Date().toISOString(),
            activo: true,
            uid: uid
          };
          
          await database.ref("usuarios/" + uid).set(nuevoUsuario);
          showMessage("¬°Registro completado exitosamente! Redirigiendo...", "success");
          
          setTimeout(() => {
            window.location.href = "index.html";
          }, 2000);
          return;
        }
      } catch (retryError) {
        console.error("Error en el reintento:", retryError);
      }
    }
    
    let errorMessage = "Error en el registro: ";
    
    switch (error.code) {
      case 'auth/email-already-in-use':
        errorMessage += "Este correo electr√≥nico ya est√° registrado.";
        break;
      case 'auth/weak-password':
        errorMessage += "La contrase√±a es muy d√©bil.";
        break;
      case 'auth/invalid-email':
        errorMessage += "Correo electr√≥nico inv√°lido.";
        break;
      case 'auth/network-request-failed':
        errorMessage += "Error de conexi√≥n. Verifica tu internet.";
        break;
      case 'PERMISSION_DENIED':
        errorMessage += "Error de permisos en la base de datos.";
        break;
      default:
        errorMessage += error.message || "Error desconocido.";
        // Mostrar m√°s informaci√≥n para debug
        if (error.code) {
          errorMessage += " (C√≥digo: " + error.code + ")";
        }
    }
    
    showMessage(errorMessage, "error");
  } finally {
    // Restaurar bot√≥n
    submitBtn.disabled = false;
    submitBtn.innerHTML = '<i class="fas fa-user-plus"></i> Registrar Contacto de Emergencia';
  }
}

// Obtener datos del formulario
function getFormData() {
  return {
    nombre: document.getElementById("nombre").value.trim(),
    apellido: document.getElementById("apellido").value.trim(),
    cedula: document.getElementById("cedula").value.trim(),
    direccion: document.getElementById("direccion").value.trim(),
    telefono: document.getElementById("telefono").value.trim(),
    email: document.getElementById("email").value.trim(),
    password: document.getElementById("password").value
  };
}

// Validar datos del formulario
function validateFormData(data) {
  // Verificar campos obligatorios
  if (!data.nombre || !data.apellido || !data.cedula || !data.direccion || !data.telefono || !data.email || !data.password) {
    showMessage("Por favor, completa todos los campos.", "error");
    return false;
  }

  // Validaci√≥n de c√©dula (10 d√≠gitos)
  if (!/^\d{10}$/.test(data.cedula)) {
    showMessage("La c√©dula debe tener exactamente 10 d√≠gitos num√©ricos.", "error");
    return false;
  }

  // Validaci√≥n de tel√©fono (10 d√≠gitos)
  if (!/^\d{10}$/.test(data.telefono)) {
    showMessage("El tel√©fono debe tener exactamente 10 d√≠gitos.", "error");
    return false;
  }

  // Validaci√≥n de email
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailRegex.test(data.email)) {
    showMessage("Por favor, ingresa un correo electr√≥nico v√°lido.", "error");
    return false;
  }

  // Validaci√≥n de contrase√±a
  if (data.password.length < 8) {
    showMessage("La contrase√±a debe tener al menos 8 caracteres.", "error");
    return false;
  }
  
  if (!/[A-Z]/.test(data.password)) {
    showMessage("La contrase√±a debe contener al menos una letra may√∫scula.", "error");
    return false;
  }
  
  if (!/\d/.test(data.password)) {
    showMessage("La contrase√±a debe contener al menos un n√∫mero.", "error");
    return false;
  }
  
  if (!/[!@#$%^&*(),.?":{}|<>]/.test(data.password)) {
    showMessage("La contrase√±a debe contener al menos un car√°cter especial.", "error");
    return false;
  }

  // Validaci√≥n de c√©dula ecuatoriana
  if (!validarCedulaEcuatoriana(data.cedula)) {
    showMessage("C√©dula ecuatoriana inv√°lida. Por favor verifica los d√≠gitos.", "error");
    return false;
  }

  return true;
}

// Verificar si ya existe un usuario con la misma c√©dula
async function verificarUsuarioExistente(cedula) {
  try {
    const snapshot = await database.ref("usuarios").orderByChild("cedula").equalTo(cedula).once("value");
    return snapshot.exists();
  } catch (error) {
    console.error("Error al verificar usuario:", error);
    return false;
  }
}

// Mostrar mensajes en la interfaz
function showMessage(text, type) {
  const mensaje = document.getElementById("mensaje");
  mensaje.textContent = text;
  mensaje.className = type;
}

// Alternar visibilidad de contrase√±a
function togglePasswordVisibility() {
  const passwordInput = document.getElementById("password");
  const toggleButton = document.getElementById("togglePassword");
  const icon = toggleButton.querySelector("i");
  
  if (passwordInput.type === "password") {
    passwordInput.type = "text";
    icon.className = "fas fa-eye-slash";
    toggleButton.setAttribute("aria-label", "Ocultar contrase√±a");
  } else {
    passwordInput.type = "password";
    icon.className = "fas fa-eye";
    toggleButton.setAttribute("aria-label", "Mostrar contrase√±a");
  }
}

// Verificar fortaleza de contrase√±a
function checkPasswordStrength(password) {
  const strengthMeter = document.getElementById("passwordStrength");
  let score = 0;
  
  if (password.length >= 8) score += 1;
  if (/[A-Z]/.test(password)) score += 1;
  if (/\d/.test(password)) score += 1;
  if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) score += 1;
  
  strengthMeter.className = "strength-meter";
  
  switch (score) {
    case 0:
    case 1:
      strengthMeter.classList.add("strength-weak");
      break;
    case 2:
    case 3:
      strengthMeter.classList.add("strength-medium");
      break;
    case 4:
      strengthMeter.classList.add("strength-strong");
      break;
  }
}

// Funci√≥n para alternar contraste
function toggleContrast() {
  isHighContrast = !isHighContrast;
  document.body.classList.toggle('high-contrast');
}

// Funci√≥n para aumentar tama√±o de fuente
function increaseFontSize() {
  currentFontSize += 2;
  if (currentFontSize > 24) {
    currentFontSize = 16;
  }
  document.body.style.fontSize = currentFontSize + "px";
}

// Funci√≥n para validar c√©dula ecuatoriana
function validarCedulaEcuatoriana(cedula) {
  if (cedula.length !== 10) return false;
  
  const digitos = cedula.split('').map(Number);
  const provincia = parseInt(cedula.substring(0, 2));
  
  if (provincia < 1 || provincia > 24) return false;
  
  const coeficientes = [2, 1, 2, 1, 2, 1, 2, 1, 2];
  let suma = 0;
  
  for (let i = 0; i < 9; i++) {
    let valor = digitos[i] * coeficientes[i];
    if (valor > 9) valor -= 9;
    suma += valor;
  }
  
  const digitoVerificador = suma % 10 === 0 ? 0 : 10 - (suma % 10);
  return digitoVerificador === digitos[9];
}

// Event Listeners
document.addEventListener("DOMContentLoaded", function() {
  // Event listener para el formulario
  const form = document.getElementById("registroForm");
  if (form) {
    form.addEventListener("submit", registrar);
  }

  // Event listener para el bot√≥n de mostrar/ocultar contrase√±a
  const togglePasswordBtn = document.getElementById("togglePassword");
  if (togglePasswordBtn) {
    togglePasswordBtn.addEventListener("click", togglePasswordVisibility);
  }

  // Event listener para verificar fortaleza de contrase√±a
  const passwordInput = document.getElementById("password");
  if (passwordInput) {
    passwordInput.addEventListener("input", function() {
      checkPasswordStrength(this.value);
    });
  }

  // Event listeners para validaci√≥n en tiempo real
  const cedulaInput = document.getElementById("cedula");
  if (cedulaInput) {
    cedulaInput.addEventListener("input", function() {
      this.value = this.value.replace(/\D/g, '').substring(0, 10);
    });
  }

  const telefonoInput = document.getElementById("telefono");
  if (telefonoInput) {
    telefonoInput.addEventListener("input", function() {
      this.value = this.value.replace(/\D/g, '').substring(0, 10);
    });
  }

  // Event listeners para accesibilidad con teclado
  document.addEventListener("keydown", function(e) {
    // ALT + C para alto contraste
    if (e.altKey && e.key === 'c') {
      e.preventDefault();
      toggleContrast();
    }
    
    // ALT + T para aumentar texto
    if (e.altKey && e.key === 't') {
      e.preventDefault();
      increaseFontSize();
    }
  });

  // Enfocar el primer campo
  const nombreInput = document.getElementById("nombre");
  if (nombreInput) {
    nombreInput.focus();
  }
});

// Manejo de estado de autenticaci√≥n
auth.onAuthStateChanged(function(user) {
  if (user) {
    console.log("Usuario autenticado:", user.email);
    console.log("UID del usuario:", user.uid);
  } else {
    console.log("No hay usuario autenticado");
  }
});

// Funci√≥n para probar la conexi√≥n a la base de datos
function testDatabaseConnection() {
  console.log("Probando conexi√≥n a la base de datos...");
  database.ref(".info/connected").on("value", function(snapshot) {
    if (snapshot.val() === true) {
      console.log("‚úÖ Conectado a Firebase Realtime Database");
    } else {
      console.log("‚ùå Desconectado de Firebase Realtime Database");
    }
  });
}

// Probar conexi√≥n al cargar la p√°gina
document.addEventListener("DOMContentLoaded", function() {
  testDatabaseConnection();
  
  // ... resto del c√≥digo existente
});
</script>
</body>
</html>